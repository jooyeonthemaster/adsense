# 구현 계획서 - 전체 통합 체크리스트

## 📋 프로젝트 개요

**프로젝트명**: 마자무 플랫폼 기능 개선 및 확장
**작성자**: 일해라컴퍼니 김주연 개발 이사
**작성일**: 2024-12-18
**총 항목**: 33건 (무료 20건 + 추가금 13건)

---

## 💰 비용 요약

### 무료 처리 항목 (20건)
- **버그 수정**: 7건
- **UI/UX 개선**: 13건
- **총 비용**: 0원

### 추가금 발생 항목 (13건)

| 가격대 | 항목 수 | 항목 내역 | 소계 |
|--------|---------|----------|------|
| 20만원 | 6건 | 환불 승인, 상품 블라인드, 추천인, 기본가격, 승인알림, 필터링 | 120만원 |
| 30만원 | 1건 | AI 리뷰 백그라운드 병렬 처리 | 30만원 |
| 50만원 | 3건 | 대량 접수 엑셀, 회원가입 멘트, 세금계산서 | 150만원 |
| 협의 | 2건 | 대량 업로드 템플릿, 블로그 배포 엑셀 | 협의 필요 |

**선택 시 최소 비용**: 120만원 (20만원 항목 6건)
**선택 시 최대 비용**: 약 300만원 (전체 선택 시)

---

## 🎯 권장 패키지

### 패키지 A: 필수 안정화 (무료)
- **내용**: 버그 수정 7건 + UI/UX 개선 13건
- **비용**: 0원
- **대상**: 모든 클라이언트 필수 적용
- **기간**: 2~3일

### 패키지 B: 업무 효율 개선 (추천) - 70만원
- **내용**:
  - 패키지 A (무료 20건)
  - AI 리뷰 백그라운드 병렬 처리 (30만원) ⭐
  - 대시보드 필터링 이동 (20만원)
  - 카카오맵 승인 알림 (20만원)
- **비용**: 70만원
- **대상**: 카카오맵 다수 진행, 관리자 업무 효율 중시
- **기간**: 1주일
- **효과**: 업무 효율 50~70% 개선

### 패키지 C: 완전 자동화 - 약 160만원
- **내용**:
  - 패키지 B (70만원)
  - 환불 승인 워크플로우 (20만원)
  - 전체 상품 블라인드 (20만원)
  - 세금계산서 발행 요청 (50만원)
- **비용**: 약 160만원
- **대상**: 대규모 운영, 완전 자동화 추구
- **기간**: 2주일

---

## 📁 구현 계획서 파일 목록

1. **구현계획서_01_무료처리항목.md** - 무료 20건 상세 계획
2. **구현계획서_02_추가금20만원.md** - 20만원 6건 상세 계획
3. **구현계획서_03_추가금30만원.md** - AI 백그라운드 처리 상세 계획
4. **구현계획서_04_추가금50만원.md** - 50만원 3건 상세 계획
5. **구현계획서_00_전체통합.md** - 이 파일 (전체 통합 체크리스트)

---

## ✅ 전체 기능 구현 체크리스트

### Phase 1: 긴급 버그 수정 (즉시 처리)

#### 🔴 최우선 (당일 처리)
- [ ] **필수정보 팝업 신규 회원 미표시 버그**
  - [ ] `app/dashboard/layout.tsx` 수정 (Line 22-25)
  - [ ] `app/onboarding/page.tsx` 수정 (Line 93-94)
  - [ ] 신규 가입자 테스트
  - [ ] 기존 사용자 테스트
  - [ ] 빌드 및 배포

---

### Phase 2: 무료 처리 항목 (2~3일)

#### 버그 수정 (6건)
- [ ] **외부계정 충전 비용 청구 버그**
  - [ ] 외부 계정 충전 API 확인
  - [ ] 비용 청구 로직 추가
  - [ ] 트랜잭션 기록 구현
  - [ ] 테스트 완료

- [ ] **리워드 중단 요청 후 오류**
  - [ ] 중단 요청 API 에러 처리
  - [ ] 트랜잭션 처리 구현
  - [ ] 상태 업데이트 검증
  - [ ] 테스트 완료

- [ ] **리워드 진행일 탭 이동 오류**
  - [ ] 진행일 컴포넌트 데이터 로딩 수정
  - [ ] 빈 데이터 UI 처리
  - [ ] 탭 전환 테스트
  - [ ] 테스트 완료

- [ ] **리워드 현황 검토 중 갯수 오류**
  - [ ] 통계 쿼리 검증
  - [ ] 상태 값 통일
  - [ ] 캐시 무효화
  - [ ] 테스트 완료

- [ ] **관리자 - 통합 접수 현황 수정**
  - [ ] 데이터 집계 로직 수정
  - [ ] 필터링 기능 구현
  - [ ] 검색 기능 구현
  - [ ] 테스트 완료

- [ ] **관리자 - 통합 접수 현황 통계 수정**
  - [ ] 통계 집계 로직 수정
  - [ ] 실시간 업데이트 구현
  - [ ] 캐시 관리
  - [ ] 테스트 완료

#### UI/UX 개선 (13건)
- [ ] **리워드 진행 현황 "인스타 매체" 추가**
- [ ] **영수증 리뷰 "검토 중" 카테고리 추가**
- [ ] **카카오맵 리뷰 "검토 중" 카테고리 추가**
- [ ] **VAT 10% 추가 표시**
- [ ] **리워드 잔액 표시 (메인/진행 현황)**
- [ ] **영수증 리뷰 잔액 표시**
- [ ] **카카오맵 리뷰 잔액 표시**
- [ ] **블로그 배포 잔액 표시**
- [ ] **카페 침투 마케팅 잔액 표시**
- [ ] **체험단 마케팅 잔액 표시**
- [ ] **카카오맵 목록 "리뷰어명" 필터 추가**
- [ ] **리워드 접수 문구 수정**

---

### Phase 3: 추가금 20만원 항목 (선택)

#### 1. 환불 승인 워크플로우 (20만원)
- [ ] **데이터베이스**
  - [ ] refund_requests 테이블 생성
  - [ ] 인덱스 추가
  - [ ] 마이그레이션 파일 작성

- [ ] **API 구현**
  - [ ] POST /api/client/refund-request
  - [ ] POST /api/admin/refund-requests/[id]/approve
  - [ ] GET /api/admin/refund-requests

- [ ] **클라이언트 UI**
  - [ ] RefundRequestDialog 컴포넌트
  - [ ] RefundStatusBadge 컴포넌트
  - [ ] 환불 요청 버튼 추가

- [ ] **관리자 UI**
  - [ ] 환불 요청 관리 페이지
  - [ ] ApproveRefundDialog 컴포넌트
  - [ ] 상태별 필터링

- [ ] **알림 시스템**
  - [ ] 관리자 알림
  - [ ] 클라이언트 알림

- [ ] **테스트**
  - [ ] 환불 요청 생성
  - [ ] 승인 처리
  - [ ] 거부 처리
  - [ ] 알림 전송

#### 2. 전체 상품 블라인드 (20만원)
- [ ] **데이터베이스**
  - [ ] product_categories.is_active 컬럼 추가
  - [ ] 인덱스 생성

- [ ] **API 구현**
  - [ ] PATCH /api/admin/products/[id]/toggle
  - [ ] GET /api/products/available

- [ ] **관리자 UI**
  - [ ] 상품 관리 페이지
  - [ ] ProductToggleSwitch 컴포넌트

- [ ] **클라이언트 UI**
  - [ ] 접수 폼 필터링 적용
  - [ ] 비활성화 안내 메시지

- [ ] **테스트**
  - [ ] 상품 활성화/비활성화
  - [ ] 클라이언트 화면 숨김 확인

#### 3. 추천인 ID 시스템 (20만원)
- [ ] **데이터베이스**
  - [ ] clients 추천 관련 컬럼 추가
  - [ ] referrals 테이블 생성
  - [ ] 추천 코드 생성 함수
  - [ ] 트리거 생성

- [ ] **API 구현**
  - [ ] GET /api/referral/validate
  - [ ] POST /api/auth/signup (추천인 처리)
  - [ ] GET /api/referral/stats

- [ ] **클라이언트 UI**
  - [ ] 회원가입 폼 추천 코드 입력
  - [ ] 추천 코드 실시간 검증
  - [ ] 마이페이지 추천 섹션
  - [ ] 추천 코드 복사 기능

- [ ] **관리자 UI**
  - [ ] 추천 통계 페이지
  - [ ] 추천 내역 테이블

- [ ] **테스트**
  - [ ] 추천 코드 생성
  - [ ] 추천 코드 검증
  - [ ] 포인트 지급

#### 4. 전체 기본 가격 설정 (20만원)
- [ ] **데이터베이스**
  - [ ] default_product_prices 테이블 생성
  - [ ] price_history 테이블 생성

- [ ] **API 구현**
  - [ ] POST /api/admin/default-prices
  - [ ] POST /api/admin/default-prices/bulk-apply
  - [ ] POST /api/admin/clients/create (자동 가격 설정)

- [ ] **관리자 UI**
  - [ ] 기본 가격 설정 페이지
  - [ ] EditDefaultPriceDialog
  - [ ] BulkApplyPricesButton

- [ ] **테스트**
  - [ ] 기본 가격 저장
  - [ ] 신규 클라이언트 자동 설정
  - [ ] 일괄 적용

#### 5. 카카오맵 승인 알림 (20만원)
- [ ] **데이터베이스**
  - [ ] notifications 테이블 확인/생성

- [ ] **API 구현**
  - [ ] POST /api/webhooks/kakaomap/approval (또는 폴링 크론)
  - [ ] GET /api/notifications
  - [ ] PATCH /api/notifications/[id]/read
  - [ ] PATCH /api/notifications/read-all

- [ ] **UI 컴포넌트**
  - [ ] NotificationCenter 컴포넌트
  - [ ] 알림 아이콘 및 배지

- [ ] **테스트**
  - [ ] 승인 감지
  - [ ] 알림 전송
  - [ ] 알림 읽음 처리

#### 6. 대시보드 필터링 이동 (20만원)
- [ ] **컴포넌트 수정**
  - [ ] StatsCard 링크 추가
  - [ ] SubmissionsTable 쿼리 파라미터 처리
  - [ ] 모든 상품 페이지 적용

- [ ] **기능**
  - [ ] URL 쿼리 파라미터 필터링
  - [ ] 필터 상태 동기화

- [ ] **테스트**
  - [ ] 통계 카드 클릭 테스트
  - [ ] URL 직접 입력
  - [ ] 브라우저 뒤로가기

---

### Phase 4: 추가금 30만원 항목 (선택, 추천)

#### AI 리뷰 백그라운드 병렬 처리 (30만원) ⭐
- [ ] **데이터베이스**
  - [ ] background_jobs 테이블 생성
  - [ ] background_job_logs 테이블 생성

- [ ] **백그라운드 시스템**
  - [ ] 작업 큐 시스템 구축
  - [ ] 워커 프로세스 구현
  - [ ] 병렬 처리 로직 (5개 배치)
  - [ ] 진행률 업데이트
  - [ ] 에러 핸들링

- [ ] **AI 생성 로직**
  - [ ] 배치 분할 로직
  - [ ] Promise.all 병렬 실행
  - [ ] Rate limiting 구현
  - [ ] 리뷰 저장

- [ ] **API 구현**
  - [ ] POST /api/admin/kakaomap/[id]/generate-ai-reviews
  - [ ] POST /api/workers/process-job
  - [ ] GET /api/background-jobs/[id]
  - [ ] GET /api/background-jobs/[id]/logs
  - [ ] POST /api/background-jobs/[id]/cancel
  - [ ] POST /api/background-jobs/[id]/retry

- [ ] **UI 컴포넌트**
  - [ ] AIGenerationButton
  - [ ] JobProgressMonitor
  - [ ] JobLogsSection
  - [ ] 관리자 작업 목록 페이지

- [ ] **테스트**
  - [ ] 50개 리뷰 생성 성능 (10분 → 3~5분)
  - [ ] 병렬 처리 정확성
  - [ ] 진행률 업데이트
  - [ ] 오류 처리 및 재시도

---

### Phase 5: 추가금 50만원 항목 (선택)

#### 1. 대량 접수 폼 엑셀 (50만원)
- [ ] **엑셀 템플릿**
  - [ ] 리뷰어 배포 템플릿 정의
  - [ ] 영수증 리뷰 템플릿 정의
  - [ ] 침투 마케팅 템플릿 정의
  - [ ] 블로그 배포 템플릿 정의
  - [ ] 템플릿 다운로드 기능

- [ ] **파싱 엔진**
  - [ ] 엑셀 파일 읽기
  - [ ] 헤더 검증
  - [ ] 데이터 타입 검증
  - [ ] 필수 필드 검증
  - [ ] 에러 수집

- [ ] **일괄 처리**
  - [ ] 백그라운드 작업 생성
  - [ ] 상품별 접수 처리
  - [ ] 진행률 업데이트
  - [ ] 에러 핸들링

- [ ] **UI**
  - [ ] 템플릿 다운로드 섹션
  - [ ] 일괄 접수 폼
  - [ ] 파싱 결과 표시
  - [ ] 진행률 모니터

- [ ] **테스트**
  - [ ] 템플릿 다운로드
  - [ ] 100건 일괄 접수

#### 2. 회원가입 멘트 커스텀 (50만원 또는 무료)
- [ ] **옵션 A: 고급 기능 (50만원)**
  - [ ] site_messages 테이블 생성
  - [ ] 관리자 메시지 관리 페이지
  - [ ] 다국어 지원
  - [ ] 변수 삽입 기능

- [ ] **옵션 B: 무료 대안**
  - [ ] config/messages.ts 파일 수정으로 대체

#### 3. 세금계산서 발행 요청 (50만원)
- [ ] **DB 스키마**
  - [ ] clients 사업자 정보 추가
  - [ ] tax_invoice_requests 테이블 생성

- [ ] **API 구현**
  - [ ] 요청 생성 API
  - [ ] 승인/발행 API

- [ ] **UI**
  - [ ] 클라이언트 사업자 정보 입력
  - [ ] 세금계산서 요청 폼
  - [ ] 관리자 요청 관리 페이지

- [ ] **테스트**
  - [ ] 요청 생성
  - [ ] 승인 처리
  - [ ] 발행 내역 관리

---

### Phase 6: 협의 필요 항목

#### 대량 업로드 템플릿 (협의)
- [ ] 요구사항 상세 확인
- [ ] 기술 스펙 정의
- [ ] 견적 산정

#### 블로그 배포 엑셀 접수 양식 (협의)
- [ ] 요구사항 상세 확인
- [ ] 기술 스펙 정의
- [ ] 견적 산정

---

## 📊 기술 스택 및 도구

### Backend
- **프레임워크**: Next.js 16.0.7 (App Router)
- **언어**: TypeScript
- **데이터베이스**: Supabase (PostgreSQL)
- **인증**: Supabase Auth
- **파일 스토리지**: Supabase Storage

### Frontend
- **UI 라이브러리**: React 19
- **스타일링**: Tailwind CSS
- **컴포넌트**: shadcn/ui
- **상태 관리**: React Context, SWR
- **폼 처리**: React Hook Form

### 외부 서비스
- **AI**: Gemini 2.0 Flash (Google)
- **엑셀 처리**: xlsx, exceljs
- **이메일**: (현재 시스템 확인 필요)
- **알림**: Database-driven notifications

### 백그라운드 처리
- **Option A**: Vercel Cron + API Routes (기본)
- **Option B**: BullMQ + Redis (고급, 권장)

---

## 🗓️ 예상 작업 일정

### 1단계: 긴급 버그 수정 (1일)
- 필수정보 팝업 버그 [최우선]
- 외부계정 충전 비용 청구 버그

### 2단계: 무료 처리 항목 (2~3일)
- 버그 수정 5건
- UI/UX 개선 13건
- **일괄 처리 후 테스트**

### 3단계: 추가금 항목 (선택) (3~7일)
- 우선: AI 리뷰 백그라운드 병렬 처리 (30만원) - 3~4일
- 이후: 20만원 항목들 순차 진행 - 각 1~2일
- 마지막: 50만원 대규모 기능 - 각 3~5일

---

## 🎯 우선순위 권장사항

### 🔴 최우선 처리 필요
**필수정보 팝업 신규 회원 미표시 버그 [무료]**
- 이유: 신규 가입자가 서비스 이용 불가
- 영향: 회원 가입 후 온보딩 진입 불가
- 작업 시간: 10분 이내
- **→ 즉시 수정 권장**

### ⚡ 높은 우선순위

**1. AI 리뷰 생성 백그라운드 병렬 처리 [30만원]** ⭐ 추천
- 이유: 업무 효율 50~70% 개선 (10분 → 3~5분)
- 영향: 관리자 작업 시간 대폭 단축
- ROI: 높음 (여러 업체 접수 시 시간 절약 효과 큼)

**2. 외부계정 충전 비용 청구 버그 [무료]**
- 이유: 매출 누락 가능성
- 영향: 외부 계정 사용 시 비용 미청구

### 📌 중간 우선순위 - 운영 효율 개선
- 대시보드 필터링 이동 [20만원]
- 카카오맵 승인 알림 [20만원]
- 환불 승인 워크플로우 [20만원]
- 전체 상품 블라인드 [20만원]

### 📝 낮은 우선순위 - 장기 개선
- 회원가입 멘트 커스텀 [50만원 or 무료 대안]
- 세금계산서 발행 요청 [50만원]
- 추천인 ID 시스템 [20만원]
- 전체 기본 가격 설정 [20만원]

---

## 🔍 품질 보증

### 코드 품질
- [ ] TypeScript 타입 에러 0개
- [ ] ESLint 에러 0개
- [ ] 빌드 성공
- [ ] 모든 페이지 정상 렌더링

### 기능 테스트
- [ ] 단위 테스트 (주요 기능)
- [ ] 통합 테스트 (API 엔드포인트)
- [ ] E2E 테스트 (주요 사용자 플로우)
- [ ] 수동 테스트 (UI/UX)

### 성능
- [ ] 페이지 로드 시간 < 3초
- [ ] API 응답 시간 < 1초
- [ ] 데이터베이스 쿼리 최적화
- [ ] 불필요한 리렌더링 제거

### 보안
- [ ] SQL Injection 방지
- [ ] XSS 방지
- [ ] CSRF 토큰 검증
- [ ] 권한 체크 (모든 API)
- [ ] 입력 값 검증

---

## 📝 배포 체크리스트

### 배포 전
- [ ] 모든 기능 테스트 완료
- [ ] 코드 리뷰 완료
- [ ] 데이터베이스 마이그레이션 준비
- [ ] 환경 변수 설정 확인
- [ ] 백업 생성

### 배포
- [ ] 스테이징 환경 배포
- [ ] 스테이징 환경 테스트
- [ ] 프로덕션 배포
- [ ] 프로덕션 모니터링 (24시간)

### 배포 후
- [ ] 주요 기능 동작 확인
- [ ] 에러 로그 모니터링
- [ ] 성능 모니터링
- [ ] 사용자 피드백 수집

---

## 📞 다음 단계

### 1. 본 보고서 검토
추가/수정 사항이 있으시면 말씀해 주세요.

### 2. 엑셀 양식 제공
대량 업로드 및 블로그 배포 엑셀 양식 확인이 필요합니다.

### 3. 추가금 항목 선택
필요한 항목만 선택하여 단계적 도입 가능합니다.

### 4. 개발 착수
우선순위에 따라 개발을 진행합니다:
- 1단계 긴급 버그 즉시 착수
- 각 단계 완료 후 검수 진행
- 피드백 반영 후 다음 단계 진행

---

## 📊 ROI (투자 대비 효과) 분석

### 패키지 B (추천 패키지) - 70만원
**주요 효과**:
- AI 리뷰 생성 시간: 10분 → 3~5분 (월 100건 시 500~700분 절약)
- 관리자 업무 효율: 대기 시간 0분 (다른 업무 병행 가능)
- 클라이언트 만족도: 실시간 진행률 확인 가능

**연간 절약 시간**: 약 100~140시간
**시급 3만원 기준**: 300~420만원 절약
**ROI**: 약 4~6배

### 전체 선택 시 - 약 280만원
**주요 효과**:
- 업무 자동화로 인력 절감
- 고객 만족도 향상
- 시스템 안정성 확보
- 확장 가능한 아키텍처

---

## ✅ 최종 체크

- [x] 무료 처리 항목 계획서 작성 완료
- [x] 추가금 20만원 항목 계획서 작성 완료
- [x] 추가금 30만원 항목 계획서 작성 완료
- [x] 추가금 50만원 항목 계획서 작성 완료
- [x] 전체 통합 체크리스트 작성 완료
- [ ] 클라이언트 최종 검토
- [ ] 추가금 항목 선택
- [ ] 개발 착수

---

**작성자**: 일해라컴퍼니 김주연 개발 이사
**작성일**: 2024-12-18
**문서 버전**: 1.0
