# êµ¬í˜„ ê³„íšì„œ - ì¶”ê°€ê¸ˆ 50ë§Œì› í•­ëª© (3ê±´)

## ğŸ“‹ ê°œìš”
- **ì´ í•­ëª©**: 3ê±´
- **ë‹¨ê°€**: ê° 50ë§Œì›
- **ì´ ë¹„ìš©**: 150ë§Œì› (3ê±´ ì„ íƒ ì‹œ)
- **ì¹´í…Œê³ ë¦¬**: ëŒ€ê·œëª¨ ê¸°ëŠ¥ ê°œë°œ

---

## 1. ëŒ€ëŸ‰ ì ‘ìˆ˜ í¼ ì—‘ì…€ ê¸°ëŠ¥ (50ë§Œì›)

### ì¶”ê°€ê¸ˆ ë°œìƒ ì´ìœ  (ë¹„ì „ë¬¸ê°€ìš©)

í˜„ì¬ëŠ” ë¦¬ë·°ì–´, ì˜ìˆ˜ì¦ ë¦¬ë·°, ì¹¨íˆ¬ë§ˆì¼€íŒ…, ë¸”ë¡œê·¸ ë°°í¬ë¥¼ **í•˜ë‚˜ì”© ìˆ˜ë™ìœ¼ë¡œ ì ‘ìˆ˜**í•´ì•¼ í•©ë‹ˆë‹¤. í´ë¼ì´ì–¸íŠ¸ê°€ 100ê±´ì„ ì ‘ìˆ˜í•˜ë ¤ë©´ 100ë²ˆ í¼ì„ ì‘ì„±í•´ì•¼ í•©ë‹ˆë‹¤.

ìš”ì²­ì‚¬í•­ì€ **ì—‘ì…€ íŒŒì¼ í•˜ë‚˜ë¡œ ì—¬ëŸ¬ ê±´ì„ í•œ ë²ˆì— ì ‘ìˆ˜**í•˜ëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤. ì´ë¥¼ ìœ„í•´ì„œëŠ”:

1. **ìƒí’ˆë³„ ì—‘ì…€ í…œí”Œë¦¿** 4ì¢… ê°œë°œ (ë¦¬ë·°ì–´/ì˜ìˆ˜ì¦/ì¹¨íˆ¬/ë¸”ë¡œê·¸)
2. **ì—‘ì…€ íŒŒì‹± ì—”ì§„** ê°œë°œ (ê²€ì¦ ë¡œì§ í¬í•¨)
3. **ì¼ê´„ ì ‘ìˆ˜ ì²˜ë¦¬** ì‹œìŠ¤í…œ ê°œë°œ
4. **ì§„í–‰ë¥  í‘œì‹œ** ë° ì—ëŸ¬ í•¸ë“¤ë§
5. **ê²°ê³¼ ë¦¬í¬íŠ¸** ìƒì„± ë° ë‹¤ìš´ë¡œë“œ

ê° ìƒí’ˆë§ˆë‹¤ ì…ë ¥ í•„ë“œê°€ ë‹¤ë¥´ê³ , ê²€ì¦ ê·œì¹™ì´ ë‹¤ë¥´ë¯€ë¡œ 4ê°œ ìƒí’ˆ Ã— ë³µì¡í•œ ë¡œì§ = ëŒ€ê·œëª¨ ê°œë°œì´ í•„ìš”í•©ë‹ˆë‹¤.

---

### êµ¬í˜„ ê³„íš

#### Step 1: ì—‘ì…€ í…œí”Œë¦¿ ì •ì˜

**1) ë¦¬ë·°ì–´ ë°°í¬ í…œí”Œë¦¿**
```typescript
// templates/excel/reviewer-template.ts
export const REVIEWER_TEMPLATE = {
  sheetName: 'ë¦¬ë·°ì–´_ë°°í¬',
  columns: [
    { key: 'company_name', label: 'ì—…ì²´ëª…*', type: 'string', required: true },
    { key: 'blog_url', label: 'ë¸”ë¡œê·¸ URL', type: 'url', required: false },
    { key: 'daily_count', label: '1ì¼ ë°œí–‰ ìˆ˜ëŸ‰*', type: 'number', required: true, min: 1 },
    { key: 'total_days', label: 'ì´ ì§„í–‰ ì¼ìˆ˜*', type: 'number', required: true, min: 1 },
    { key: 'keywords', label: 'í‚¤ì›Œë“œ (ì‰¼í‘œ êµ¬ë¶„)', type: 'string', required: false },
    { key: 'notes', label: 'ë¹„ê³ ', type: 'string', required: false },
  ],
  sampleData: [
    ['ë§ˆìë¬´ ì¹´í˜', 'https://blog.naver.com/mazamu', 5, 30, 'ì¹´í˜, ë””ì €íŠ¸, ë¸ŒëŸ°ì¹˜', 'ì£¼ë§ ì œì™¸'],
    ['í–‰ë³µí•œ ë ˆìŠ¤í† ë‘', '', 3, 20, 'ë§›ì§‘, ë°ì´íŠ¸', ''],
  ],
};
```

**2) ì˜ìˆ˜ì¦ ë¦¬ë·° í…œí”Œë¦¿**
```typescript
export const RECEIPT_TEMPLATE = {
  sheetName: 'ì˜ìˆ˜ì¦_ë¦¬ë·°',
  columns: [
    { key: 'company_name', label: 'ì—…ì²´ëª…*', type: 'string', required: true },
    { key: 'naver_place_url', label: 'ë„¤ì´ë²„ í”Œë ˆì´ìŠ¤ URL*', type: 'url', required: true },
    { key: 'total_count', label: 'ì´ ë¦¬ë·° ìˆ˜*', type: 'number', required: true, min: 1 },
    { key: 'photo_required', label: 'ì‚¬ì§„ í•„ìˆ˜ ì—¬ë¶€ (Y/N)', type: 'boolean', required: false },
    { key: 'notes', label: 'ë¹„ê³ ', type: 'string', required: false },
  ],
  sampleData: [
    ['ë§ˆìë¬´ ì¹´í˜', 'https://m.place.naver.com/restaurant/12345', 50, 'Y', ''],
    ['í–‰ë³µí•œ ë ˆìŠ¤í† ë‘', 'https://m.place.naver.com/restaurant/67890', 30, 'N', 'ì£¼ë§ ì§‘ì¤‘'],
  ],
};
```

**3) ì¹¨íˆ¬ ë§ˆì¼€íŒ… í…œí”Œë¦¿**
```typescript
export const INFILTRATION_TEMPLATE = {
  sheetName: 'ì¹¨íˆ¬_ë§ˆì¼€íŒ…',
  columns: [
    { key: 'company_name', label: 'ì—…ì²´ëª…*', type: 'string', required: true },
    { key: 'service_type', label: 'ì„œë¹„ìŠ¤ íƒ€ì…* (cafe/community)', type: 'string', required: true },
    { key: 'cafe_list', label: 'ì¹´í˜ ëª©ë¡ (ì‰¼í‘œ êµ¬ë¶„)', type: 'string', required: false },
    { key: 'total_count', label: 'ì´ ê²Œì‹œë¬¼ ìˆ˜*', type: 'number', required: true, min: 1 },
    { key: 'has_photo', label: 'ì‚¬ì§„ í¬í•¨ (Y/N)', type: 'boolean', required: false },
    { key: 'script', label: 'ì›ê³ ', type: 'text', required: false },
    { key: 'notes', label: 'ë¹„ê³ ', type: 'string', required: false },
  ],
  sampleData: [
    ['ë§ˆìë¬´ ì¹´í˜', 'cafe', 'ë‹¤ìŒì¹´í˜ ë§›ì§‘, ë„¤ì´ë²„ ì¹´í˜ ë¸ŒëŸ°ì¹˜', 20, 'Y', 'ë§›ìˆëŠ” ë¸ŒëŸ°ì¹˜...', ''],
  ],
};
```

**4) ë¸”ë¡œê·¸ ë°°í¬ í…œí”Œë¦¿**
```typescript
export const BLOG_TEMPLATE = {
  sheetName: 'ë¸”ë¡œê·¸_ë°°í¬',
  columns: [
    { key: 'company_name', label: 'ì—…ì²´ëª…*', type: 'string', required: true },
    { key: 'distribution_type', label: 'ë°°í¬ íƒ€ì…* (video/reviewer/automation)', type: 'string', required: true },
    { key: 'blog_url', label: 'ë¸”ë¡œê·¸ URL', type: 'url', required: false },
    { key: 'daily_count', label: '1ì¼ ë°œí–‰ ìˆ˜ëŸ‰*', type: 'number', required: true, min: 1 },
    { key: 'total_days', label: 'ì´ ì§„í–‰ ì¼ìˆ˜*', type: 'number', required: true, min: 1 },
    { key: 'keywords', label: 'í‚¤ì›Œë“œ (ì‰¼í‘œ êµ¬ë¶„)', type: 'string', required: false },
    { key: 'notes', label: 'ë¹„ê³ ', type: 'string', required: false },
  ],
  sampleData: [
    ['ë§ˆìë¬´ ì¹´í˜', 'reviewer', 'https://blog.naver.com/mazamu', 5, 30, 'ì¹´í˜, ë¸ŒëŸ°ì¹˜', ''],
  ],
};
```

---

#### Step 2: ì—‘ì…€ í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ ê¸°ëŠ¥

```typescript
// lib/excel/template-generator.ts
import * as XLSX from 'xlsx';

export function generateExcelTemplate(productType: string) {
  let template;

  switch (productType) {
    case 'reviewer':
      template = REVIEWER_TEMPLATE;
      break;
    case 'receipt':
      template = RECEIPT_TEMPLATE;
      break;
    case 'infiltration':
      template = INFILTRATION_TEMPLATE;
      break;
    case 'blog':
      template = BLOG_TEMPLATE;
      break;
    default:
      throw new Error('Unknown product type');
  }

  // í—¤ë” í–‰
  const headers = template.columns.map(col => col.label);

  // ìƒ˜í”Œ ë°ì´í„°
  const data = [headers, ...template.sampleData];

  // ì›Œí¬ì‹œíŠ¸ ìƒì„±
  const ws = XLSX.utils.aoa_to_sheet(data);

  // ì»¬ëŸ¼ ë„ˆë¹„ ì„¤ì •
  ws['!cols'] = template.columns.map(col => ({ wch: 20 }));

  // ì›Œí¬ë¶ ìƒì„±
  const wb = XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb, ws, template.sheetName);

  // íŒŒì¼ëª…
  const fileName = `${template.sheetName}_ì–‘ì‹.xlsx`;

  // ë‹¤ìš´ë¡œë“œ
  XLSX.writeFile(wb, fileName);
}

// ì‚¬ìš©
generateExcelTemplate('reviewer'); // ë¦¬ë·°ì–´_ë°°í¬_ì–‘ì‹.xlsx ë‹¤ìš´ë¡œë“œ
```

**UI ì»´í¬ë„ŒíŠ¸**:
```typescript
// components/admin/bulk-submission/template-download.tsx
export function TemplateDownloadSection() {
  const templates = [
    { type: 'reviewer', label: 'ë¦¬ë·°ì–´ ë°°í¬', icon: Users },
    { type: 'receipt', label: 'ì˜ìˆ˜ì¦ ë¦¬ë·°', icon: Camera },
    { type: 'infiltration', label: 'ì¹¨íˆ¬ ë§ˆì¼€íŒ…', icon: Target },
    { type: 'blog', label: 'ë¸”ë¡œê·¸ ë°°í¬', icon: FileText },
  ];

  return (
    <Card>
      <CardHeader>
        <CardTitle>ì—‘ì…€ ì–‘ì‹ ë‹¤ìš´ë¡œë“œ</CardTitle>
        <CardDescription>
          ìƒí’ˆë³„ ì—‘ì…€ ì–‘ì‹ì„ ë‹¤ìš´ë¡œë“œí•˜ì—¬ ì‘ì„±í•´ì£¼ì„¸ìš”.
        </CardDescription>
      </CardHeader>
      <CardContent>
        <div className="grid grid-cols-2 gap-4">
          {templates.map(({ type, label, icon: Icon }) => (
            <Button
              key={type}
              variant="outline"
              className="h-20 flex flex-col gap-2"
              onClick={() => generateExcelTemplate(type)}
            >
              <Icon className="h-6 w-6" />
              <span>{label}</span>
            </Button>
          ))}
        </div>
      </CardContent>
    </Card>
  );
}
```

---

#### Step 3: ì—‘ì…€ íŒŒì‹± ë° ê²€ì¦

```typescript
// lib/excel/bulk-parser.ts
import * as XLSX from 'xlsx';

export interface ParsedRow {
  rowNumber: number;
  data: Record<string, any>;
  errors: string[];
}

export interface ParseResult {
  success: ParsedRow[];
  failed: ParsedRow[];
  summary: {
    total: number;
    valid: number;
    invalid: number;
  };
}

export async function parseBulkSubmissionExcel(
  file: File,
  productType: string
): Promise<ParseResult> {
  const template = getTemplate(productType);

  // 1. ì—‘ì…€ íŒŒì¼ ì½ê¸°
  const arrayBuffer = await file.arrayBuffer();
  const workbook = XLSX.read(arrayBuffer, { type: 'array' });
  const worksheet = workbook.Sheets[workbook.SheetNames[0]];
  const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 }) as any[][];

  // 2. í—¤ë” ê²€ì¦
  const headers = jsonData[0];
  const expectedHeaders = template.columns.map(col => col.label);

  const headerErrors = validateHeaders(headers, expectedHeaders);
  if (headerErrors.length > 0) {
    throw new Error(`í—¤ë” ì˜¤ë¥˜: ${headerErrors.join(', ')}`);
  }

  // 3. ë°ì´í„° í–‰ íŒŒì‹±
  const success: ParsedRow[] = [];
  const failed: ParsedRow[] = [];

  for (let i = 1; i < jsonData.length; i++) {
    const row = jsonData[i];
    const rowNumber = i + 1;

    // ë¹ˆ í–‰ ê±´ë„ˆë›°ê¸°
    if (!row || row.every(cell => !cell)) continue;

    // í–‰ ë°ì´í„° ë³€í™˜
    const rowData: Record<string, any> = {};
    const errors: string[] = [];

    template.columns.forEach((col, index) => {
      const value = row[index];

      // í•„ìˆ˜ í•„ë“œ ê²€ì¦
      if (col.required && !value) {
        errors.push(`${col.label}ì€(ëŠ”) í•„ìˆ˜ì…ë‹ˆë‹¤.`);
        return;
      }

      // íƒ€ì…ë³„ ê²€ì¦ ë° ë³€í™˜
      try {
        rowData[col.key] = validateAndConvertValue(value, col);
      } catch (error) {
        errors.push(`${col.label}: ${error.message}`);
      }
    });

    // ê²°ê³¼ ë¶„ë¥˜
    if (errors.length === 0) {
      success.push({ rowNumber, data: rowData, errors: [] });
    } else {
      failed.push({ rowNumber, data: rowData, errors });
    }
  }

  return {
    success,
    failed,
    summary: {
      total: success.length + failed.length,
      valid: success.length,
      invalid: failed.length,
    },
  };
}

// ê°’ ê²€ì¦ ë° ë³€í™˜
function validateAndConvertValue(value: any, column: ColumnDefinition): any {
  if (!value && !column.required) return null;

  switch (column.type) {
    case 'string':
      return String(value).trim();

    case 'number':
      const num = Number(value);
      if (isNaN(num)) throw new Error('ìˆ«ìê°€ ì•„ë‹™ë‹ˆë‹¤.');
      if (column.min !== undefined && num < column.min) {
        throw new Error(`ìµœì†Œê°’ì€ ${column.min}ì…ë‹ˆë‹¤.`);
      }
      if (column.max !== undefined && num > column.max) {
        throw new Error(`ìµœëŒ€ê°’ì€ ${column.max}ì…ë‹ˆë‹¤.`);
      }
      return num;

    case 'url':
      const url = String(value).trim();
      if (!isValidURL(url)) throw new Error('ìœ íš¨í•˜ì§€ ì•Šì€ URLì…ë‹ˆë‹¤.');
      return url;

    case 'boolean':
      const str = String(value).trim().toUpperCase();
      if (str === 'Y' || str === 'YES' || str === 'ë„¤' || str === 'TRUE') return true;
      if (str === 'N' || str === 'NO' || str === 'ì•„ë‹ˆì˜¤' || str === 'FALSE') return false;
      throw new Error('Y ë˜ëŠ” Në§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.');

    case 'text':
      return String(value).trim();

    default:
      return value;
  }
}

// URL ê²€ì¦
function isValidURL(url: string): boolean {
  try {
    new URL(url);
    return true;
  } catch {
    return false;
  }
}
```

---

#### Step 4: ì¼ê´„ ì ‘ìˆ˜ ì²˜ë¦¬

```typescript
// app/api/admin/bulk-submission/process/route.ts
export async function POST(request: Request) {
  const formData = await request.formData();
  const file = formData.get('file') as File;
  const productType = formData.get('product_type') as string;
  const session = await getServerSession();

  // 1. ì—‘ì…€ íŒŒì‹±
  const parseResult = await parseBulkSubmissionExcel(file, productType);

  if (parseResult.summary.valid === 0) {
    return Response.json(
      { error: 'ìœ íš¨í•œ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.', details: parseResult },
      { status: 400 }
    );
  }

  // 2. ë°±ê·¸ë¼ìš´ë“œ ì‘ì—… ìƒì„±
  const { data: job } = await supabase
    .from('background_jobs')
    .insert({
      type: 'bulk_submission',
      status: 'pending',
      total_items: parseResult.success.length,
      payload: {
        product_type: productType,
        submissions: parseResult.success.map(r => r.data),
        failed_rows: parseResult.failed,
      },
      created_by: session.user.id,
    })
    .select()
    .single();

  // 3. ì›Œì»¤ íŠ¸ë¦¬ê±°
  await triggerBackgroundWorker(job.id);

  return Response.json({
    success: true,
    job_id: job.id,
    summary: parseResult.summary,
    failed_rows: parseResult.failed,
  });
}

// ë°±ê·¸ë¼ìš´ë“œ ì›Œì»¤ì—ì„œ ì‹¤í–‰
async function processBulkSubmission(job: BackgroundJob) {
  const { product_type, submissions } = job.payload;

  let completed = 0;
  let failed = 0;

  for (const submission of submissions) {
    try {
      // ìƒí’ˆ íƒ€ì…ë³„ ì ‘ìˆ˜ ì²˜ë¦¬
      await createSubmission(product_type, submission);
      completed++;

      // ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
      await updateJobProgress(job.id, completed, failed, submissions.length);

      await createJobLog(job.id, 'info', `${submission.company_name} ì ‘ìˆ˜ ì™„ë£Œ`);

    } catch (error) {
      failed++;
      await createJobLog(
        job.id,
        'error',
        `${submission.company_name} ì ‘ìˆ˜ ì‹¤íŒ¨: ${error.message}`
      );
    }

    // Rate limiting
    await sleep(500);
  }

  return { completed, failed };
}

// ìƒí’ˆë³„ ì ‘ìˆ˜ ìƒì„±
async function createSubmission(productType: string, data: any) {
  switch (productType) {
    case 'reviewer':
      return await createReviewerSubmission(data);
    case 'receipt':
      return await createReceiptSubmission(data);
    case 'infiltration':
      return await createInfiltrationSubmission(data);
    case 'blog':
      return await createBlogSubmission(data);
  }
}
```

---

#### Step 5: ì¼ê´„ ì ‘ìˆ˜ UI

```typescript
// components/admin/bulk-submission/bulk-upload-form.tsx
'use client';

export function BulkUploadForm() {
  const [productType, setProductType] = useState('');
  const [file, setFile] = useState<File | null>(null);
  const [loading, setLoading] = useState(false);
  const [jobId, setJobId] = useState<string | null>(null);
  const [result, setResult] = useState<any>(null);

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    if (!file || !productType) return;

    setLoading(true);
    try {
      const formData = new FormData();
      formData.append('file', file);
      formData.append('product_type', productType);

      const res = await fetch('/api/admin/bulk-submission/process', {
        method: 'POST',
        body: formData,
      });

      const data = await res.json();

      if (res.ok) {
        setJobId(data.job_id);
        setResult(data);
        toast.success('ì¼ê´„ ì ‘ìˆ˜ê°€ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.');
      } else {
        toast.error(data.error || 'ì¼ê´„ ì ‘ìˆ˜ ì‹¤íŒ¨');
        setResult(data.details);
      }
    } finally {
      setLoading(false);
    }
  };

  return (
    <Card>
      <CardHeader>
        <CardTitle>ì¼ê´„ ì ‘ìˆ˜</CardTitle>
        <CardDescription>
          ì—‘ì…€ íŒŒì¼ë¡œ ì—¬ëŸ¬ ê±´ì„ í•œ ë²ˆì— ì ‘ìˆ˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        </CardDescription>
      </CardHeader>
      <CardContent>
        <form onSubmit={handleSubmit} className="space-y-4">
          {/* ìƒí’ˆ ì„ íƒ */}
          <div>
            <Label>ìƒí’ˆ ì„ íƒ *</Label>
            <Select value={productType} onValueChange={setProductType}>
              <SelectTrigger>
                <SelectValue placeholder="ìƒí’ˆì„ ì„ íƒí•˜ì„¸ìš”" />
              </SelectTrigger>
              <SelectContent>
                <SelectItem value="reviewer">ë¦¬ë·°ì–´ ë°°í¬</SelectItem>
                <SelectItem value="receipt">ì˜ìˆ˜ì¦ ë¦¬ë·°</SelectItem>
                <SelectItem value="infiltration">ì¹¨íˆ¬ ë§ˆì¼€íŒ…</SelectItem>
                <SelectItem value="blog">ë¸”ë¡œê·¸ ë°°í¬</SelectItem>
              </SelectContent>
            </Select>
          </div>

          {/* íŒŒì¼ ì—…ë¡œë“œ */}
          <div>
            <Label>ì—‘ì…€ íŒŒì¼ ì—…ë¡œë“œ *</Label>
            <Input
              type="file"
              accept=".xlsx,.xls"
              onChange={(e) => setFile(e.target.files?.[0] || null)}
            />
            {file && (
              <p className="text-sm text-gray-500 mt-1">
                ì„ íƒëœ íŒŒì¼: {file.name}
              </p>
            )}
          </div>

          {/* ì œì¶œ ë²„íŠ¼ */}
          <Button type="submit" disabled={!productType || !file || loading}>
            {loading ? 'ì²˜ë¦¬ ì¤‘...' : 'ì¼ê´„ ì ‘ìˆ˜ ì‹œì‘'}
          </Button>
        </form>

        {/* ê²°ê³¼ í‘œì‹œ */}
        {result && (
          <div className="mt-6">
            <Alert>
              <AlertTitle>íŒŒì‹± ê²°ê³¼</AlertTitle>
              <AlertDescription>
                <div className="mt-2 space-y-1">
                  <div>ì´ í–‰: {result.summary.total}ê°œ</div>
                  <div className="text-green-600">ìœ íš¨: {result.summary.valid}ê°œ</div>
                  <div className="text-red-600">ì˜¤ë¥˜: {result.summary.invalid}ê°œ</div>
                </div>
              </AlertDescription>
            </Alert>

            {/* ì˜¤ë¥˜ í–‰ í‘œì‹œ */}
            {result.failed_rows && result.failed_rows.length > 0 && (
              <div className="mt-4">
                <h4 className="font-semibold mb-2">ì˜¤ë¥˜ ë‚´ì—­</h4>
                <div className="max-h-48 overflow-y-auto border rounded p-2">
                  {result.failed_rows.map((row: any, index: number) => (
                    <div key={index} className="text-sm p-2 border-b">
                      <div className="font-semibold">í–‰ {row.rowNumber}</div>
                      <ul className="text-red-600 text-xs ml-4">
                        {row.errors.map((error: string, i: number) => (
                          <li key={i}>â€¢ {error}</li>
                        ))}
                      </ul>
                    </div>
                  ))}
                </div>
              </div>
            )}
          </div>
        )}

        {/* ì§„í–‰ë¥  ëª¨ë‹ˆí„° */}
        {jobId && <JobProgressMonitor jobId={jobId} />}
      </CardContent>
    </Card>
  );
}
```

---

### ì²´í¬ë¦¬ìŠ¤íŠ¸

#### ì—‘ì…€ í…œí”Œë¦¿
- [ ] ë¦¬ë·°ì–´ ë°°í¬ í…œí”Œë¦¿ ì •ì˜
- [ ] ì˜ìˆ˜ì¦ ë¦¬ë·° í…œí”Œë¦¿ ì •ì˜
- [ ] ì¹¨íˆ¬ ë§ˆì¼€íŒ… í…œí”Œë¦¿ ì •ì˜
- [ ] ë¸”ë¡œê·¸ ë°°í¬ í…œí”Œë¦¿ ì •ì˜
- [ ] í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ ê¸°ëŠ¥
- [ ] ìƒ˜í”Œ ë°ì´í„° í¬í•¨

#### íŒŒì‹± ì—”ì§„
- [ ] ì—‘ì…€ íŒŒì¼ ì½ê¸°
- [ ] í—¤ë” ê²€ì¦
- [ ] ë°ì´í„° íƒ€ì… ê²€ì¦
- [ ] í•„ìˆ˜ í•„ë“œ ê²€ì¦
- [ ] URL ê²€ì¦
- [ ] ì—ëŸ¬ ìˆ˜ì§‘ ë° ë¦¬í¬íŒ…

#### ì¼ê´„ ì²˜ë¦¬
- [ ] ë°±ê·¸ë¼ìš´ë“œ ì‘ì—… ìƒì„±
- [ ] ìƒí’ˆë³„ ì ‘ìˆ˜ ì²˜ë¦¬ ë¡œì§
- [ ] ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
- [ ] ì—ëŸ¬ í•¸ë“¤ë§
- [ ] ì‘ì—… ë¡œê·¸ ê¸°ë¡

#### UI
- [ ] í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ ì„¹ì…˜
- [ ] ì¼ê´„ ì ‘ìˆ˜ í¼
- [ ] íŒŒì¼ ì—…ë¡œë“œ
- [ ] íŒŒì‹± ê²°ê³¼ í‘œì‹œ
- [ ] ì˜¤ë¥˜ í–‰ ìƒì„¸ í‘œì‹œ
- [ ] ì§„í–‰ë¥  ëª¨ë‹ˆí„°

#### í…ŒìŠ¤íŠ¸
- [ ] ê° ìƒí’ˆë³„ í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ
- [ ] ì—‘ì…€ íŒŒì‹± ì •í™•ì„± í…ŒìŠ¤íŠ¸
- [ ] 100ê±´ ì¼ê´„ ì ‘ìˆ˜ í…ŒìŠ¤íŠ¸
- [ ] ì—ëŸ¬ ì²˜ë¦¬ í…ŒìŠ¤íŠ¸
- [ ] ì§„í–‰ë¥  ì—…ë°ì´íŠ¸ í…ŒìŠ¤íŠ¸

---

## 2. íšŒì›ê°€ì… ë©˜íŠ¸ ê´€ë¦¬ì ì»¤ìŠ¤í…€ (50ë§Œì›)

### ì¶”ê°€ê¸ˆ ë°œìƒ ì´ìœ  (ë¹„ì „ë¬¸ê°€ìš©)

í˜„ì¬ íšŒì›ê°€ì… ì‹œ í‘œì‹œë˜ëŠ” í™˜ì˜ ë©”ì‹œì§€ëŠ” ì½”ë“œì— ê³ ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ìš”ì²­ì‚¬í•­ì€ **ê´€ë¦¬ìê°€ ì§ì ‘ ë©”ì‹œì§€ë¥¼ ë³€ê²½**í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤.

í•˜ì§€ë§Œ ì´ëŠ” ë‹¨ìˆœí•œ í…ìŠ¤íŠ¸ ë³€ê²½ì´ ì•„ë‹™ë‹ˆë‹¤:
1. **ë‹¤êµ­ì–´ ì§€ì›** í•„ìš” (í•œêµ­ì–´/ì˜ì–´)
2. **ë¯¸ë¦¬ë³´ê¸°** ê¸°ëŠ¥ (ë³€ê²½ ì „ í™•ì¸)
3. **ë²„ì „ ê´€ë¦¬** (ì´ì „ ë©”ì‹œì§€ ë³µêµ¬)
4. **ë³€ìˆ˜ ì‚½ì…** ê¸°ëŠ¥ ({íšŒì‚¬ëª…}, {ì´ë©”ì¼} ë“±)
5. **ì•ˆì „ ê²€ì¦** (HTML injection ë°©ì§€)

**ë˜ëŠ” ë¬´ë£Œ ëŒ€ì•ˆ**: ê´€ë¦¬ìê°€ ì§ì ‘ ì½”ë“œë¥¼ ìˆ˜ì •í•˜ëŠ” ê²ƒìœ¼ë¡œ ëŒ€ì²´ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì´ ê²½ìš° ì¶”ê°€ ë¹„ìš© ì—†ì´ ì²˜ë¦¬ ê°€ëŠ¥í•©ë‹ˆë‹¤.

---

### êµ¬í˜„ ê³„íš (ê³ ê¸‰ ê¸°ëŠ¥)

#### Step 1: DB ìŠ¤í‚¤ë§ˆ

```sql
CREATE TABLE site_messages (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  key TEXT UNIQUE NOT NULL, -- 'welcome_message', 'onboarding_intro', etc.
  content JSONB NOT NULL, -- { ko: "í•œêµ­ì–´", en: "English" }
  variables JSONB, -- { company_name: "íšŒì‚¬ëª…", email: "ì´ë©”ì¼" }
  version INT DEFAULT 1,
  is_active BOOLEAN DEFAULT true,
  updated_by UUID REFERENCES users(id),
  updated_at TIMESTAMPTZ DEFAULT NOW(),
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- ë²„ì „ íˆìŠ¤í† ë¦¬
CREATE TABLE message_history (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  message_id UUID REFERENCES site_messages(id),
  content JSONB NOT NULL,
  version INT NOT NULL,
  updated_by UUID REFERENCES users(id),
  created_at TIMESTAMPTZ DEFAULT NOW()
);
```

#### Step 2: ê´€ë¦¬ì ë©”ì‹œì§€ ê´€ë¦¬ í˜ì´ì§€

```typescript
// app/admin/site-messages/page.tsx
export default async function SiteMessagesPage() {
  const { data: messages } = await supabase
    .from('site_messages')
    .select('*')
    .order('key');

  return (
    <div className="container mx-auto py-8">
      <h1 className="text-3xl font-bold mb-6">ì‚¬ì´íŠ¸ ë©”ì‹œì§€ ê´€ë¦¬</h1>

      <div className="space-y-4">
        {messages?.map((message) => (
          <MessageEditCard key={message.id} message={message} />
        ))}
      </div>
    </div>
  );
}
```

---

### ë¬´ë£Œ ëŒ€ì•ˆ (ê°„ë‹¨í•œ ë°©ë²•)

ê´€ë¦¬ìê°€ ì½”ë“œ íŒŒì¼ì„ ì§ì ‘ ìˆ˜ì •:

```typescript
// config/messages.ts
export const SITE_MESSAGES = {
  welcome: 'ë§ˆìë¬´ì— ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤!',
  onboarding_intro: 'ê°„ë‹¨í•œ ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.',
};
```

ì´ íŒŒì¼ë§Œ ìˆ˜ì •í•˜ë©´ ëª¨ë“  ê³³ì— ë°˜ì˜ë©ë‹ˆë‹¤. **ì¶”ê°€ ê°œë°œ ë¹„ìš© ì—†ìŒ**.

---

## 3. ì„¸ê¸ˆê³„ì‚°ì„œ ë°œí–‰ ìš”ì²­ ê¸°ëŠ¥ (50ë§Œì›)

### ì¶”ê°€ê¸ˆ ë°œìƒ ì´ìœ  (ë¹„ì „ë¬¸ê°€ìš©)

í˜„ì¬ëŠ” í´ë¼ì´ì–¸íŠ¸ê°€ ì„¸ê¸ˆê³„ì‚°ì„œê°€ í•„ìš”í•  ë•Œ **ë³„ë„ë¡œ ì—°ë½**í•´ì•¼ í•©ë‹ˆë‹¤. ìš”ì²­ì‚¬í•­ì€ **ì‹œìŠ¤í…œ ë‚´ì—ì„œ ì„¸ê¸ˆê³„ì‚°ì„œ ë°œí–‰ì„ ìš”ì²­**í•˜ëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤.

ì´ëŠ” ë‹¤ìŒì´ í•„ìš”í•©ë‹ˆë‹¤:
1. **ì‚¬ì—…ì ì •ë³´ ê´€ë¦¬** (ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸, íšŒì‚¬ ì£¼ì†Œ ë“±)
2. **ë°œí–‰ ìš”ì²­ í¼** ë° ì›Œí¬í”Œë¡œìš°
3. **ê´€ë¦¬ì ìŠ¹ì¸ ì‹œìŠ¤í…œ**
4. **ë°œí–‰ ë‚´ì—­ ê´€ë¦¬**
5. **êµ­ì„¸ì²­ ì—°ë™ ì¤€ë¹„** (í–¥í›„ ìë™ ë°œí–‰ ëŒ€ë¹„)

---

### êµ¬í˜„ ê³„íš

#### Step 1: ì‚¬ì—…ì ì •ë³´ ì¶”ê°€

```sql
ALTER TABLE clients
ADD COLUMN business_registration_number VARCHAR(20),
ADD COLUMN business_owner VARCHAR(100),
ADD COLUMN business_address TEXT,
ADD COLUMN business_type VARCHAR(100),
ADD COLUMN business_category VARCHAR(100);
```

#### Step 2: ì„¸ê¸ˆê³„ì‚°ì„œ ìš”ì²­ í…Œì´ë¸”

```sql
CREATE TABLE tax_invoice_requests (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  client_id UUID NOT NULL REFERENCES clients(id),

  -- ë°œí–‰ ì •ë³´
  issue_date DATE NOT NULL,
  supply_amount INT NOT NULL, -- ê³µê¸‰ê°€ì•¡
  tax_amount INT NOT NULL, -- ì„¸ì•¡
  total_amount INT NOT NULL, -- í•©ê³„

  -- ë¹„ê³ 
  description TEXT,
  related_submissions JSONB, -- ê´€ë ¨ ì ‘ìˆ˜ ê±´ë“¤

  -- ìƒíƒœ
  status TEXT DEFAULT 'pending', -- 'pending', 'approved', 'issued', 'rejected'
  approved_by UUID REFERENCES users(id),
  approved_at TIMESTAMPTZ,
  issued_at TIMESTAMPTZ,
  invoice_number VARCHAR(50),

  -- íŒŒì¼
  invoice_file_url TEXT,

  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);
```

#### Step 3: í´ë¼ì´ì–¸íŠ¸ ìš”ì²­ í¼

```typescript
// components/dashboard/tax-invoice-request-form.tsx
export function TaxInvoiceRequestForm() {
  // ì‚¬ì—…ì ì •ë³´ ì…ë ¥
  // ë°œí–‰ ê¸°ê°„ ì„ íƒ
  // ê¸ˆì•¡ ìë™ ê³„ì‚°
  // ìš”ì²­ ì œì¶œ
}
```

#### Step 4: ê´€ë¦¬ì ìŠ¹ì¸ ë° ë°œí–‰

```typescript
// app/admin/tax-invoices/page.tsx
// ìš”ì²­ ëª©ë¡
// ìŠ¹ì¸/ê±°ë¶€ ì²˜ë¦¬
// ë°œí–‰ ë²ˆí˜¸ ì…ë ¥
// PDF ì—…ë¡œë“œ
```

---

### ì²´í¬ë¦¬ìŠ¤íŠ¸

#### DB ë° API
- [ ] ì‚¬ì—…ì ì •ë³´ í•„ë“œ ì¶”ê°€
- [ ] ì„¸ê¸ˆê³„ì‚°ì„œ ìš”ì²­ í…Œì´ë¸” ìƒì„±
- [ ] ìš”ì²­ ìƒì„± API
- [ ] ìŠ¹ì¸/ë°œí–‰ API

#### UI
- [ ] í´ë¼ì´ì–¸íŠ¸ ì‚¬ì—…ì ì •ë³´ ì…ë ¥
- [ ] ì„¸ê¸ˆê³„ì‚°ì„œ ìš”ì²­ í¼
- [ ] ê´€ë¦¬ì ìš”ì²­ ê´€ë¦¬ í˜ì´ì§€
- [ ] ë°œí–‰ ë‚´ì—­ ì¡°íšŒ

#### ê¸°ëŠ¥
- [ ] ê¸ˆì•¡ ìë™ ê³„ì‚°
- [ ] ìŠ¹ì¸ ì›Œí¬í”Œë¡œìš°
- [ ] íŒŒì¼ ì—…ë¡œë“œ
- [ ] ë°œí–‰ ë‚´ì—­ ê´€ë¦¬

---

## ğŸ“Š ì¶”ê°€ê¸ˆ 50ë§Œì› í•­ëª© ìš”ì•½

| ìˆœë²ˆ | í•­ëª© | ë¹„ìš© | ì£¼ìš” ê¸°ëŠ¥ |
|-----|------|------|----------|
| 1 | ëŒ€ëŸ‰ ì ‘ìˆ˜ í¼ ì—‘ì…€ | 50ë§Œì› | 4ê°œ ìƒí’ˆ ì¼ê´„ ì ‘ìˆ˜ ì‹œìŠ¤í…œ |
| 2 | íšŒì›ê°€ì… ë©˜íŠ¸ ì»¤ìŠ¤í…€ | 50ë§Œì› ë˜ëŠ” ë¬´ë£Œ | ê´€ë¦¬ì ë©”ì‹œì§€ ê´€ë¦¬ (ë¬´ë£Œ ëŒ€ì•ˆ ê°€ëŠ¥) |
| 3 | ì„¸ê¸ˆê³„ì‚°ì„œ ë°œí–‰ ìš”ì²­ | 50ë§Œì› | ì‚¬ì—…ì ì •ë³´ ë° ë°œí–‰ ì›Œí¬í”Œë¡œìš° |

**ì´ ë¹„ìš©**: 100~150ë§Œì› (2ë²ˆ ë¬´ë£Œ ëŒ€ì•ˆ ì„ íƒ ì‹œ 100ë§Œì›)
